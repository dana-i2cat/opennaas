<?xml version="1.0" encoding="UTF-8"?>
<features xmlns="http://karaf.apache.org/xmlns/features/v1.0.0">
	<repository>mvn:org.apache.karaf.assemblies.features/standard/${karaf.version}/xml/features</repository>
	<repository>mvn:org.apache.karaf.assemblies.features/enterprise/${karaf.version}/xml/features</repository>
	<repository>mvn:org.apache.servicemix.nmr/apache-servicemix-nmr/${nmr.version}/xml/features</repository>
	<repository>mvn:org.apache.camel.karaf/apache-camel/${camel.version}/xml/features</repository>
	<repository>mvn:org.apache.cxf.karaf/apache-cxf/${cxf.version}/xml/features</repository>
	<repository>mvn:org.apache.cxf.dosgi/cxf-dosgi/${cxf.dosgi.version}/xml/features</repository>


	<!-- Required to install CXF in servicemix without NMR, activeMQ and camel -->
	<feature name="opennaas-cxf-deps" version="${project.version}">
		<feature version="${spring.version}">spring</feature>
		<feature version="2013.01">opennaas-servicemix-shared</feature>
		<feature>saaj</feature>
		<bundle dependency="true">mvn:javax.xml.soap/javax.xml.soap-api/${xml.soap.api.version}</bundle>
		<bundle dependency="true">mvn:org.apache.geronimo.specs/geronimo-ws-metadata_2.0_spec/${geronimo.wsmetadata.version}</bundle>
	</feature>
	
	<!-- Modification of servicemix servicemix-shared feature using opennaas-jbi instead of original nmr jbi-->
	<feature name="opennaas-servicemix-shared" version="2013.01" resolver="(obr)" start-level="50">
		<!-- <feature version="1.6.1">jbi</feature> -->
		<feature version="1.6.1">opennaas-jbi</feature>
		<feature version="3.0.7.RELEASE">spring</feature>
		<bundle dependency="true">mvn:org.apache.ws.xmlschema/xmlschema-core/2.0.3</bundle>
		<bundle dependency="true">mvn:javax.mail/mail/1.4.4</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.wsdl4j/1.6.2_6</bundle>
		<bundle>mvn:org.apache.xbean/xbean-spring/3.11.1</bundle>
		<bundle>mvn:org.apache.xbean/xbean-classloader/3.11.1</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix/servicemix-utils/1.6.0</bundle>
		<bundle>mvn:org.apache.servicemix/servicemix-common/2013.01</bundle>
		<bundle>mvn:org.apache.servicemix/servicemix-soap/2013.01</bundle>
		<bundle>mvn:org.apache.servicemix/servicemix-soap2/2013.01</bundle>
	</feature>
	
	<!-- Modification of nmr jbi feature exchanging naming 1.6.1 for jndi 0.3-->
	<!-- The naming service in our platform is provided by Apache Aries JNDI Core -->
	<feature name="opennaas-jbi" version="1.6.1" resolver="(obr)" start-level="50">
		<!-- <feature version="1.6.1">naming</feature> -->
		<feature version="0.3">jndi</feature>
		<feature version="[0.3, 1)">transaction</feature>
		<feature version="1.6.1">nmr</feature>
		<feature version="4.2.0">woodstox</feature>
		<bundle dependency="true">mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.activation-api-1.1/2.2.0</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.jbi-api-1.0/2.2.0</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.wsdl4j/1.6.2_6</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.ant/1.7.0_6</bundle>
		<bundle dependency="true">mvn:org.apache.xbean/xbean-spring/3.11.1</bundle>
		<bundle dependency="true">mvn:org.apache.xbean/xbean-classloader/3.11.1</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix/servicemix-common/2013.01</bundle>
		<bundle>mvn:org.apache.servicemix.jbi/org.apache.servicemix.jbi.runtime/1.6.1</bundle>
		<bundle>mvn:org.apache.servicemix.jbi/org.apache.servicemix.jbi.osgi/1.6.1</bundle>
		<bundle>mvn:org.apache.servicemix.jbi/org.apache.servicemix.jbi.deployer/1.6.1</bundle>
		<bundle>mvn:org.apache.servicemix.jbi/org.apache.servicemix.jbi.commands/1.6.1</bundle>
	</feature>
	
	<feature name="opennaas-cxf" version="${project.version}">
		<feature version="${project.version}">opennaas-cxf-deps</feature>
		<feature version="${cxf.version}">cxf</feature>
		<feature version="${cxf.dosgi.version}">cxf-dosgi-discovery-local</feature>
	</feature>
	
	<feature name="opennaas-base" version="${project.version}">
		<feature version="${project.version}">opennaas-cxf</feature>
	</feature>

	<feature name="opennaas-core" version="${project.version}">
		<feature version="${project.version}">opennaas-base</feature>
		<feature version="${project.version}">opennaas-persistence</feature>
		<feature version="${project.version}">opennaas-resources</feature>
		<feature version="${project.version}">opennaas-ws-rest</feature>
		<feature version="${project.version}">opennaas-spring-security</feature>
		
	</feature>
	
	<feature name="opennaas-resources" version="${project.version}">
		<feature>xml-specs-api</feature>  
		<feature version="${cxf.version}">cxf-specs</feature>
		
		<feature version="${project.version}">opennaas-persistence</feature>
		
		<bundle dependency="true">mvn:org.osgi/org.osgi.compendium/${osgi.version}</bundle>
		<bundle dependency="true">mvn:org.apache.felix/org.apache.felix.eventadmin/${felix.eventadmin.version}</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.jsr311-api-1.1/${servicemix.specs.version}</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.jsr339-api-m10/${servicemix.specs.version}</bundle> 

		<bundle>mvn:org.opennaas/org.opennaas.core.resources/${project.version}</bundle>
	</feature>	
	
	
	<feature name="opennaas-persistence" version="${project.version}">
	
		<feature version="${spring.version}">spring</feature>
		<feature>jndi</feature>
		<feature>jpa</feature>

		<bundle dependency="true">mvn:org.apache.geronimo.specs/geronimo-servlet_2.5_spec/${geronimo.servlet.version}</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.cglib/${servicemix.cglib.version}</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.serp/${servicemix.serp.version}</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-dbcp/${commons.dbcp.version}</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-lang/${commons.lang.version}</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-collections/${commons.collections.version}</bundle>
		<bundle dependency="true">mvn:commons-pool/commons-pool/${commons.pool.version}</bundle>
		<bundle dependency="true">mvn:org.hsqldb/com.springsource.org.hsqldb/${hsqldb.version}</bundle>
		<bundle dependency="true">mvn:org.apache.openjpa/openjpa/${openjpa.version}</bundle>

		<bundle>mvn:org.opennaas/org.opennaas.core.hsqldb/${project.version}</bundle>
		<bundle>mvn:org.opennaas/org.opennaas.core.persistence/${project.version}</bundle>
	</feature>


	<feature name="opennaas-spring-security" version="${project.version}">
		<feature version="${project.version}">opennaas-persistence</feature>
		<feature version="${project.version}">opennaas-spring-jdbc</feature>
		<feature version="${project.version}">opennaas-resources</feature>
		
		<feature version="${spring.version}">spring</feature>
		<feature version="${spring.version}">spring-web</feature>
		<feature version="${spring.osgi.version}">spring-dm</feature>
		<feature version="${spring.osgi.version}">spring-dm-web</feature>
		
		<bundle dependency="true">mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.jsr311-api-1.1/${servicemix.specs.version}</bundle>		
		<bundle dependency="true">mvn:org.springframework/org.springframework.transaction/${spring.version}</bundle>
		<bundle dependency="true">mvn:org.springframework.security/spring-security-core/${spring.security.version}</bundle>
		<bundle dependency="true">mvn:org.springframework.security/spring-security-config/${spring.security.version}</bundle>
		<bundle dependency="true">mvn:org.springframework.security/spring-security-acl/${spring.security.version}</bundle>
		<bundle dependency="true">mvn:org.springframework.security/spring-security-web/${spring.security.version}</bundle>

		<bundle>mvn:org.opennaas/org.opennaas.core.security/${project.version}</bundle>
	</feature>
	
	
	<feature name="opennaas-ws-rest" version="${project.version}">
		<feature>jetty</feature>
		<feature>http</feature>
		<feature version="${project.version}">cxf-minimal</feature>
		
		<bundle dependency="true">mvn:org.osgi/org.osgi.enterprise/${osgi.version}</bundle>
		<bundle dependency="true">mvn:org.codehaus.woodstox/stax2-api/${stax2.api.version}</bundle>
		<bundle dependency="true">mvn:org.codehaus.woodstox/woodstox-core-asl/${woodstox.asl.version}</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.dom4j/${dom4j.version}</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.jsr339-api-m10/${servicemix.specs.version}</bundle> 
		<bundle dependency="true">mvn:org.apache.cxf.dosgi/cxf-dosgi-ri-discovery-local/${cxf.dosgi.version}</bundle>
		<bundle dependency="true">mvn:org.apache.cxf.dosgi/cxf-dosgi-ri-dsw-cxf/${cxf.dosgi.version}</bundle>
		<bundle dependency="true">mvn:org.apache.cxf.dosgi/cxf-dosgi-ri-topology-manager/${cxf.dosgi.version}</bundle>
	<!--  	<bundle dependency="true">mvn:org.springframework.osgi/spring-osgi-core/${spring.osgi.version}</bundle>
		<bundle dependency="true">mvn:org.springframework.osgi/spring-osgi-io/${spring.osgi.version}</bundle>
		<bundle dependency="true">mvn:org.springframework.osgi/spring-osgi-extender/${spring.osgi.version}</bundle> -->
		<bundle dependency="true">mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.jsr311-api-1.1/${servicemix.specs.version}</bundle>
		<bundle dependency="true">mvn:org.apache.ws.commons.schema/XmlSchema/${xmlschema.version}</bundle>
		
	</feature>	
	
	<feature name="opennaas-spring-jdbc" version="${project.version}">

		<feature version="${spring.version}">spring</feature>
		
		<bundle>mvn:org.springframework/spring-tx/${spring.version}</bundle>
		<bundle>mvn:org.springframework/spring-jdbc/${spring.version}</bundle>
	</feature>	

	<feature name="cxf-minimal" version="${project.version}">
		<feature version="${cxf.version}">cxf-specs</feature>
		<feature version="${project.version}">opennaas-jaxws</feature>	
		
		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xmlresolver/${xml.resolver.version}</bundle>
		<bundle dependency="true">mvn:joda-time/joda-time/1.6.2</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.opensaml/${opensaml.version}</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.jdom/${jdom.version}</bundle>
		<bundle dependency="true">mvn:org.apache.ws.xmlschema/xmlschema-core/2.0</bundle>
	<!--  	<bundle dependency="true">mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.jaxws-api-2.2/1.8.0</bundle> -->
		<bundle dependency="true">mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.saaj-api-1.3/${servicemix.saaj.specs}</bundle>		
		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.wsdl4j/${wsdl4j.version}</bundle>		
		<bundle dependency="true">mvn:org.apache.neethi/neethi/${neethi.version}</bundle>		
		<bundle dependency="true">mvn:org.apache.geronimo.specs/geronimo-ws-metadata_2.0_spec/${geronimo.wsmetadata.version}</bundle>	

		<!-- Bundles replace the cxf-bundle-minimal, since it contains bugs in MANIFEST -->
		<bundle dependency="true">mvn:org.apache.cxf/cxf-api/${cxf.version}</bundle>	
		<bundle dependency="true">mvn:org.apache.cxf/cxf-rt-core/${cxf.version}</bundle>
		<bundle dependency="true">mvn:org.apache.cxf/cxf-rt-bindings-xml/${cxf.version}</bundle>	
		<bundle dependency="true">mvn:org.apache.cxf/cxf-rt-transports-http/${cxf.version}</bundle>		
		<bundle dependency="true">mvn:org.apache.cxf/cxf-rt-frontend-jaxrs/${cxf.version}</bundle>		
		<bundle dependency="true">mvn:org.apache.cxf/cxf-rt-bindings-soap/${cxf.version}</bundle>		
		<bundle dependency="true">mvn:org.apache.cxf/cxf-rt-databinding-aegis/${cxf.version}</bundle>
		<bundle dependency="true">mvn:org.apache.cxf/cxf-rt-databinding-jaxb/${cxf.version}</bundle>		
		<bundle dependency="true">mvn:org.apache.cxf/cxf-rt-frontend-simple/${cxf.version}</bundle>		
		<bundle dependency="true">mvn:org.apache.cxf/cxf-rt-frontend-jaxws/${cxf.version}</bundle>		
		<bundle dependency="true">mvn:org.apache.cxf/cxf-rt-rs-extension-providers/${cxf.version}</bundle>		
				
		<!--  <bundle dependency="true">mvn:org.apache.cxf/cxf-bundle-minimal/${cxf.version}</bundle> -->

	</feature>
	
	<feature name="opennaas-jaxws" version="${project.version}">
		<bundle dependency="true">mvn:javax.xml.soap/javax.xml.soap-api/${xml.soap.api.version}</bundle>
		<bundle dependency="true">mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.jaxws-api-2.2/${servicemix.specs.version}</bundle>
	</feature>
	
	<feature name="nexus-testprofile" version="${project.version}">
		<feature version="${project.version}">opennaas-core</feature>
		
		<bundle>mvn:org.opennaas/org.opennaas.core.tests-mockprofile/${project.version}</bundle>
	</feature>
	
	<feature name="itests-helpers" version="${project.version}">
		<feature version="${opennaas.version}">opennaas-core</feature>
		<feature version="${opennaas.version}">cxf-minimal</feature>
			
		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.javax-inject/${servicemix.javax-inject.version}</bundle>
		
		<bundle>mvn:org.opennaas.itests/org.opennaas.itests.helpers/${project.version}</bundle>
	</feature>
	
</features>